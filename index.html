<html>
	<head>
		<link rel="stylesheet" href="css/style.css" type="text/css" />
		<script type="text/javascript" src="js/jquery-1.5.min.js"></script>
		<script type="text/javascript" src="js/jquery-css-transform.js" type="text/javascript"></script>
		<script type="text/javascript" src="js/jquery-animate-css-rotate-scale.js" type="text/javascript"></script>
	</head>
	<body onload="init()">
		<div id="othumb" class="othumb"></div>
		<img src="photos/THUMB_DSCpennies.jpg" class="thumbnail" id="th0" onclick="mtc(0)">
<img src="photos/THUMB_DSCperforated-leaf.jpg" class="thumbnail" id="th1" onclick="mtc(1)">
<img src="photos/THUMB_DSCred-paint.jpg" class="thumbnail" id="th2" onclick="mtc(2)">
<img src="photos/THUMB_DSCwater-beads.jpg" class="thumbnail" id="th3" onclick="mtc(3)">
<img src="photos/THUMB_DSCgreen-sweat-bee.jpg" class="thumbnail" id="th4" onclick="mtc(4)">
<img src="photos/THUMB_DSCdaisy-detail.jpg" class="thumbnail" id="th5" onclick="mtc(5)">
<img src="photos/THUMB_DSCbee-5.jpg" class="thumbnail" id="th6" onclick="mtc(6)">
<img src="photos/THUMB_DSCbutton-flowers.jpg" class="thumbnail" id="th7" onclick="mtc(7)">
<img src="photos/THUMB_DSCchip-2.jpg" class="thumbnail" id="th8" onclick="mtc(8)">
<img src="photos/THUMB_DSCchips-2.jpg" class="thumbnail" id="th9" onclick="mtc(9)">
<img src="photos/THUMB_DSCbee-10.jpg" class="thumbnail" id="th10" onclick="mtc(10)">
		<div id="tshadow"></div>
		<div id="mlarge">
			
			<div id="tlarge">
				<div id="olarge" class="olarge">
					<img id="large" src="about:blank">
					<img id="loading" src="images/loading.gif">
				</div>
			</div>
		</div>
		<div id="debug">
		</div>
		<script type="text/javascript"> 
		var ie = false;
		</script>
		
		<!--[if lt IE 9]>
		<script type="text/javascript"> 
		ie = true;
		</script>
		<![endif]-->

		 <script type="text/javascript"> 
		 /*
		 * Jakub Kramarz (c) 2011
		 */
		 var total = 10;
		 var mini = 0;
		 var maxi = 0;
		 var center = 0;
		 var actual = 0;
		 var much = 7;
		 var names = new Array('DSCpennies.jpg', 'DSCperforated-leaf.jpg', 'DSCred-paint.jpg', 'DSCwater-beads.jpg', 'DSCgreen-sweat-bee.jpg', 'DSCdaisy-detail.jpg', 'DSCbee-5.jpg', 'DSCbutton-flowers.jpg', 'DSCchip-2.jpg', 'DSCchips-2.jpg', 'DSCbee-10.jpg');
		 var surl;
		 var onstart = true;
		 
		 function position(i){
			var rotate = center - actual + (i-center);
			var Element = document.getElementById( 'th'+i );
			
			$(
				function(){
					if(ie){
						$('#th'+i).animate({top: (window.innerHeight/2)+(-75*rotate)+"px"}, 500);
					}else{
						$('#th'+i).animate({rotate: ((-0.15*rotate)+"rad")}, 500);
					}
				}
			);
		 }
		 
		 function hide(i){
			 position(i);
			 var Element = document.getElementById( 'th'+i );
			 $(
				function(){
					$('#th'+i).fadeOut('fast');
				}
			);
		 }
		 function show(i){
			 var Element = document.getElementById( 'th'+i );
			 Element.style.display="block";
			 position(i);
			 $(
				function(){
					$('#th'+i).hide();
					/*$('#th'+i).load(
						function(){*/
							$('#th'+i).fadeTo('fast', 0.8);
					/*	}
					);*/
				}
			);
		 }
		 function large(newc){
			if(center != newc || onstart){	 
				$(function(){
					$('#large').fadeOut('fast',
						function(){
							var Element = document.getElementById( 'large' );
							Element.src='photos/' + names[newc];
							
						}
					);
				});
				 
				$(function(){
					$('#large').load(
						function(){
							/*$('#loading').hide('fast', function(){*/$('#large').fadeIn('slow');/*});*/
						}
					);
				});
			}
		}
		 function mtc(newc){	
			 actual = newc;
			 large(newc);
			 var newmini = Math.max( (actual - much), 0);
			 var newmaxi = Math.min( (actual + much), total);
			 
			if(mini < newmini){
				for(var i = mini; i<=newmini; i++){
					hide(i);
				}
			}
			if(mini > newmini){
				for(var i = mini; i>=newmini; i--){
					show(i);
				}
			}
			for (var i= mini;i<=maxi;i++){
				 position(i);
			}
			
			if(newmaxi > maxi){
				for(var i = newmaxi; i>maxi; i--){
					show(i);
				}
			}
			if(newmaxi < maxi){
				for(var i = newmaxi; i<=maxi; i++){
					hide(i);
				}
			}
			
			document.all.debug.innerHTML = 
				'MinI: ' + mini + '<br>' +
				'MaxI: ' + maxi + '<br>' +
				'Center: ' + center + '<br>' +
				'NewMinI: ' + newmini + '<br>' +
				'NewMaxI: ' + newmaxi + '<br>' +
				'NewCenter: ' + actual + '<br>';
			mini = newmini;
			maxi = newmaxi;
			center = actual;
			window.location = surl.concat('#!', center.toString());
			onstart = false;
		}

		function init(){
			var url = window.location.toString();
			var pos = url.lastIndexOf("#!");
			var num;
			if(pos < 0){
				num = 0;
				surl = url;
			}else{
				num = url.substr(pos+2);
				surl = url.substr(0, pos);
			}
			
			num=mini=maxi=center=parseInt(num);
			show(num);
			mtc(num);
			
			document.all.debug.innerHTML = surl;
		}
		 </script>
	</body>
</html>
